<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yuk Tashish - MyTaxi Cargo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: url('https://images.unsplash.com/photo-1600585154340-be6161a56a0c?auto=format&fit=crop&w=1920') no-repeat center center fixed;
            background-size: cover;
            min-height: 100vh;
            position: relative;
        }
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.85);
            z-index: -1;
        }
        .animate-slide-up {
            animation: slideUp 0.5s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .nav-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .nav-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        .neon-button {
            transition: background-color 0.3s ease, transform 0.3s ease;
        }
        .neon-button:hover {
            background-color: #d4a017;
            transform: scale(1.05);
        .
        }
    </style>
</head>
<body class="flex flex-col">
    <header class="bg-white shadow-lg py-6 text-center animate-slide-up">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTPwk0qRl1MeQgAsNBbOxaFgzsMds1_Vn0Nbw&s" alt="MyTaxi Cargo Logo" class="mx-auto h-24 mb-3">
        <h1 class="text-3xl font-bold text-yellow-500">Yuk Tashish Ma'lumotlari</h1>
    </header>

    <div class="container max-w-4xl mx-auto p-6 bg-white rounded-2xl shadow-2xl my-6 animate-slide-up">
        <section class="nav-section mb-8">
            <h2 class="text-2xl font-medium text-center text-gray-800 mb-6">Yuk Tashish Turi</h2>
            <div class="nav-options flex flex-wrap gap-4 justify-center">
                <div class="nav-card bg-gray-50 p-4 rounded-lg border border-gray-200 cursor-pointer">
                    <input type="radio" name="cargo-type" id="standard" value="standard" checked class="hidden" onchange="updateInputs()">
                    <label for="standard" class="flex items-center text-lg font-medium text-gray-700"><i class="fas fa-box mr-2 text-yellow-500"></i> Standard</label>
                </div>
                <div class="nav-card bg-gray-50 p-4 rounded-lg border border-gray-200 cursor-pointer">
                    <input type="radio" name="cargo-type" id="express" value="express" class="hidden" onchange="updateInputs()">
                    <label for="express" class="flex items-center text-lg font-medium text-gray-700"><i class="fas fa-shipping-fast mr-2 text-yellow-500"></i> Ekspress</label>
                </div>
                <div class="nav-card bg-gray-50 p-4 rounded-lg border border-gray-200 cursor-pointer">
                    <input type="radio" name="cargo-type" id="heavy" value="heavy" class="hidden" onchange="updateInputs()">
                    <label for="heavy" class="flex items-center text-lg font-medium text-gray-700"><i class="fas fa-truck mr-2 text-yellow-500"></i> Og‘ir Yuk</label>
                </div>
            </div>
        </section>

        <section class="info-section bg-gray-50 p-6 rounded-lg shadow-md mb-8">
            <p class="flex items-center text-gray-700 mb-2"><i class="fas fa-map-marker-alt mr-2 text-yellow-500"></i><span class="font-semibold">Qayerdan:</span> <span id="from" class="ml-2"></span></p>
            <p class="flex items-center text-gray-700 mb-2"><i class="fas fa-flag-checkered mr-2 text-yellow-500"></i><span class="font-semibold">Qayerga:</span> <span id="to" class="ml-2"></span></p>
            <p class="flex items-center text-gray-700 mb-2"><i class="fas fa-box mr-2 text-yellow-500"></i><span class="font-semibold">Yuk turi:</span> <span id="cargoType" class="ml-2"></span></p>
            <p class="flex items-center text-gray-700 mb-2"><i class="fas fa-car-alt mr-2 text-yellow-500"></i><span class="font-semibold">Moshina markasi:</span> <span id="carBrand" class="ml-2"></span></p>
            <p class="flex items-center text-gray-700 mb-2"><i class="fas fa-car-side mr-2 text-yellow-500"></i><span class="font-semibold">Moshina modeli:</span> <span id="carModel" class="ml-2"></span></p>
            <p class="flex items-center text-gray-700 mb-2"><i class="fas fa-ruler-combined mr-2 text-yellow-500"></i><span class="font-semibold">Moshina o‘lchamlari (Uzunlik x Eni):</span> <span id="carDimensions" class="ml-2"></span></p>
            <div class="flex items-center text-gray-700 mb-2">
                <i class="fas fa-weight mr-2 text-yellow-500"></i>
                <span class="font-semibold">Yuk vazni (kg):</span>
                <input type="number" id="packageWeight" min="0.1" step="0.1" value="1" class="ml-2 w-24 p-2 border border-gray-300 rounded-md" oninput="previewFare()">
            </div>
            <p class="flex items-center text-gray-700 mb-2"><i class="fas fa-boxes mr-2 text-yellow-500"></i><span class="font-semibold">Yuk turi:</span> <span class="ml-2">Oddiy</span></p>
            <p class="flex items-center text-gray-700 mb-2"><i class="fas fa-calendar-alt mr-2 text-yellow-500"></i><span class="font-semibold">Yetkazib berish vaqti:</span> <span class="ml-2">19.06.2025 16:22</span></p>
            <div class="flex items-center text-gray-700 mb-2">
                <i class="fas fa-sms mr-2 text-yellow-500"></i>
                <label class="flex items-center">
                    <input type="checkbox" id="smsNotification" class="mr-2">
                    SMS bildirishnoma yuborish
                </label>
            </div>
            <p class="flex items-center text-gray-700 mb-2"><i class="fas fa-user mr-2 text-yellow-500"></i><span class="font-semibold">Kuryer:</span> <span id="driverName" class="ml-2"></span></p>
            <p class="flex items-center text-gray-700 mb-2"><i class="fas fa-phone mr-2 text-yellow-500"></i><span class="font-semibold">Telefon raqami:</span> <a href="tel:" id="driverPhone" class="ml-2 text-yellow-600 hover:underline"></a></p>
            <p class="flex items-center text-gray-700"><i class="fas fa-car mr-2 text-yellow-500"></i><span class="font-semibold">Moshina raqami:</span> <span id="carNumber" class="ml-2"></span></p>
        </section>

        <div class="fare-preview bg-gray-100 p-4 rounded-lg mb-6 text-center">
            <p class="text-lg font-semibold text-gray-800">Taxminiy narx: <span id="previewFare">0</span> UZS</p>
        </div>

        <button class="neon-button bg-yellow-500 text-white py-3 px-8 rounded-lg mx-auto flex items-center text-lg font-medium" onclick="typeof calculateDelivery === 'function' ? calculateDelivery() : console.error('calculateDelivery is not defined')">
            <i class="fas fa-calculator mr-2"></i> Narx va Vaqtni Hisoblash
        </button>

        <div class="result-section hidden mt-8 p-6 bg-gray-50 rounded-lg shadow-md text-center" id="result">
            <p class="flex items-center justify-center text-gray-700 mb-2"><i class="fas fa-ruler mr-2 text-yellow-500"></i><span class="font-semibold">Masofa:</span> <span id="distance" class="ml-2"></span> km</p>
            <p class="flex items-center justify-center text-gray-700 mb-2"><i class="fas fa-clock mr-2 text-yellow-500"></i><span class="font-semibold">Taxminiy yetib kelish vaqti:</span> <span id="time" class="ml-2"></span> daqiqa</p>
            <p class="flex items-center justify-center text-gray-700 mb-2"><i class="fas fa-money-bill-wave mr-2 text-yellow-500"></i><span class="font-semibold">Narx:</span> <span id="fare" class="ml-2"></span> UZS</p>
            <div class="fare-breakdown text-left text-sm text-gray-600 mt-4">
                <p>Asosiy narx: <span id="baseFare"></span> UZS</p>
                <p>Masofa uchun: <span id="distanceFare"></span> UZS</p>
                <p>Yuk vazni uchun: <span id="cargoFare"></span> UZS</p>
            </div>
            <div id="map" class="w-full h-80 rounded-lg mt-4"></div>
            <div class="mt-4">
                <p class="text-gray-700">Kuzatuv havolasi: <a href="#" id="trackingLink" class="text-yellow-600 hover:underline">Havolani ulashish</a></p>
            </div>
        </div>

        <div class="feedback-section mt-8 p-6 bg-gray-50 rounded-lg shadow-md text-center">
            <h3 class="text-xl font-medium mb-4">Xizmat sifatini baholang</h3>
            <div class="stars text-2xl text-gray-300 cursor-pointer" id="ratingStars">
                <i class="fas fa-star" data-value="1"></i>
                <i class="fas fa-star" data-value="2"></i>
                <i class="fas fa-star" data-value="3"></i>
                <i class="fas fa-star" data-value="4"></i>
                <i class="fas fa-star" data-value="5"></i>
            </div>
        </div>

        <a href="{% url 'home' %}" class="neon-button bg-yellow-500 text-white py-3 px-8 rounded-lg mx-auto flex items-center text-lg font-medium mt-6"><i class="fas fa-arrow-left mr-2"></i> Orqaga</a>
    </div>

    <footer class="footer mt-auto bg-white py-4 text-center shadow-inner">
        <p class="text-gray-600">Biz bilan bog'laning:
            <a href="tel:+998123456789" class="text-yellow-500 hover:underline">+998 123 456 789</a> |
            <a href="mailto:cargo@mytaxi.uz" class="text-yellow-500 hover:underline">cargo@mytaxi.uz</a>
        </p>
        <p><a href="#" class="text-yellow-500 hover:underline">Ilovamizni yuklab oling</a></p>
        <p class="text-gray-600">© 2025 MyTaxi Cargo. Barcha huquqlar himoyalangan.</p>
    </footer>

    <script src="https://api-maps.yandex.ru/2.1/?lang=uz_UZ&apikey=YOUR_API_KEY"></script>
    <script>
        let myMap, route;

        ymaps.ready(function () {
            myMap = new ymaps.Map("map", {
                center: [41.311081, 69.240562], // Toshkent markazi
                zoom: 12,
                controls: ['zoomControl', 'geolocationControl']
            });
        });

        function generateRandomDriver() {
            const names = ["Ali Vohidov", "Bobur Mirzaev", "Davron Juraev", "Eldor Rahimov", "Farrux Xo‘jayev", "G‘olib Toshmatov", "Hasan Karimov", "Islom Odilov"];
            const randomName = names[Math.floor(Math.random() * names.length)];
            const phonePrefix = "+998";
            const phoneCodes = ["90", "91", "93", "94", "95", "97", "98", "99"];
            const randomCode = phoneCodes[Math.floor(Math.random() * phoneCodes.length)];
            const phoneNumber = `${phonePrefix}${randomCode}${Math.floor(1000000 + Math.random() * 9000000)}`;
            const regionCode = String(Math.floor(10 + Math.random() * 90)).padStart(2, '0');
            const letters = "ABCDEF";
            const randomLetter = letters[Math.floor(Math.random() * letters.length)];
            const numberPart = String(Math.floor(100 + Math.random() * 900)).padStart(3, '0');
            const carNumber = `${regionCode} ${randomLetter} ${numberPart}`;
            return { name: randomName, phone: phoneNumber, carNumber: carNumber };
        }

        function updateVehicleInfo(cargoType) {
            const vehicleInfo = {
                standard: { brand: 'Chevrolet', model: 'Express', dimensions: '5.4m x 2.0m' },
                express: { brand: 'Hyundai', model: 'H350', dimensions: '6.2m x 2.1m' },
                heavy: { brand: 'Toyota', model: 'Dyna', dimensions: '7.0m x 2.3m' }
            };
            document.getElementById('carBrand').textContent = vehicleInfo[cargoType].brand;
            document.getElementById('carModel').textContent = vehicleInfo[cargoType].model;
            document.getElementById('carDimensions').textContent = vehicleInfo[cargoType].dimensions;
        }

        function updateDriverInfo() {
            const driver = generateRandomDriver();
            document.getElementById('driverName').textContent = driver.name;
            const phoneLink = document.getElementById('driverPhone');
            phoneLink.textContent = driver.phone;
            phoneLink.href = `tel:${driver.phone}`;
            document.getElementById('carNumber').textContent = driver.carNumber;
        }

        function generateTrackingLink() {
            const trackingId = Math.random().toString(36).substr(2, 9);
            document.getElementById('trackingLink').href = `https://mytaxi.uz/track/${trackingId}`;
            document.getElementById('trackingLink').textContent = `mytaxi.uz/track/${trackingId}`;
        }

        async function previewFare() {
            const cargoType = document.querySelector('input[name="cargo-type"]:checked').value || 'standard';
            const packageWeight = parseFloat(document.getElementById('packageWeight').value) || 1;

            let baseFare = 10000;
            let pricePerKm = 5000;
            let weightMultiplier = 1;

            if (cargoType === 'express') {
                pricePerKm *= 1.5;
                baseFare *= 1.2;
            }
            if (cargoType === 'heavy') {
                pricePerKm *= 2;
                baseFare *= 1.5;
            }

            if (packageWeight > 10) {
                weightMultiplier = 1 + (packageWeight - 10) * 0.05;
            }

            const estimatedDistance = 5; // Taxminiy masofa
            const estimatedFare = Math.round((estimatedDistance * pricePerKm + baseFare) * weightMultiplier);

            document.getElementById('previewFare').textContent = estimatedFare.toLocaleString();
        }

            async function calculateDelivery() {

                const urlParams = new URLSearchParams(window.location.search);
                const from = urlParams.get('from') || 'Toshkent, Chorsu Bozori';
                const to = urlParams.get('to') || 'Toshkent, Mustaqillik Maydoni';
                const cargoType = document.querySelector('input[name="cargo-type"]:checked').value || urlParams.get('cargoType') || 'standard';
                const packageWeight = parseFloat(document.getElementById('packageWeight').value) || 1;
                const smsNotification = document.getElementById('smsNotification').checked;

                document.getElementById('from').textContent = from;
                document.getElementById('to').textContent = to;
                document.getElementById('cargoType').textContent = cargoType.charAt(0).toUpperCase() + cargoType.slice(1);

                updateVehicleInfo(cargoType);

                if (!from || !to) {
                    alert("Iltimos, boshlang‘ich va yakuniy manzillarni kiriting!");
                    return;
                }

                if (packageWeight < 0.1) {
                    alert("Iltimos, yuk vaznini to‘g‘ri kiriting (minimum 0.1 kg)!");
                    return;
                }

                const resultDiv = document.getElementById('result');
                const distanceSpan = document.getElementById('distance');
                const timeSpan = document.getElementById('time');
                const fareSpan = document.getElementById('fare');
                const baseFareSpan = document.getElementById('baseFare');
                const distanceFareSpan = document.getElementById('distanceFare');
                const cargoFareSpan = document.getElementById('cargoFare');

                try {
                    // Генерация случайного расстояния и времени, как в примере calculateFare
                    const distance = Math.random() * 10 + 5; // Случайное расстояние от 5 до 15 км
                    const time = Math.round(distance * 2); // Примерное время в минутах (2 мин/км)

                    let baseFare = 10000;
                    let pricePerKm = 5000;
                    if (cargoType === 'express') pricePerKm *= 1.5;
                    if (cargoType === 'heavy') pricePerKm *= 1.5;

                    const distanceFare = Math.round(distance * pricePerKm);
                    const weightMultiplier = packageWeight > 10 ? 1 + (packageWeight - 10) * 0.05 : 1;
                    const cargoFee = Math.round((baseFare + distanceFare) * (weightMultiplier - 1));
                    const totalFare = Math.round((baseFare + distanceFare) * weightMultiplier);

                    distanceSpan.textContent = distance.toFixed(1);
                    timeSpan.textContent = time;
                    fareSpan.textContent = totalFare.toLocaleString();
                    baseFareSpan.textContent = baseFare.toLocaleString();
                    distanceFareSpan.textContent = distanceFare.toLocaleString();
                    cargoFareSpan.textContent = cargoFee.toLocaleString();

                    resultDiv.classList.remove('hidden');
                    updateDriverInfo();
                    generateTrackingLink();

                    if (smsNotification) console.log("SMS bildirishnoma yuborildi: Buyurtma tasdiqlandi, yetkazib berish vaqti 19.06.2025 16:22");
                } catch (error) {
                    console.error('Xatolik:', error);
                    alert(`Xatolik: ${error.message}. Iltimos, manzillarni tekshirib qayta urinib ko‘ring.`);
                }
            }
        function initRatingStars() {
            const stars = document.querySelectorAll('#ratingStars i');
            stars.forEach(star => {
                star.addEventListener('click', () => {
                    const value = parseInt(star.getAttribute('data-value'));
                    stars.forEach(s => {
                        s.classList.toggle('text-yellow-500', parseInt(s.getAttribute('data-value')) <= value);
                    });
                    console.log(`Baholandi: ${value} yulduz`);
                });
            });
        }

        function updateInputs() {
            previewFare();
            const cargoType = document.querySelector('input[name="cargo-type"]:checked').value || 'standard';
            updateVehicleInfo(cargoType);
        }

        window.onload = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const from = urlParams.get('from') || 'Toshkent, Chorsu Bozori';
            const to = urlParams.get('to') || 'Toshkent, Mustaqillik Maydoni';
            const cargoType = urlParams.get('cargoType') || 'standard';

            document.getElementById('from').textContent = from;
            document.getElementById('to').textContent = to;
            document.getElementById('cargoType').textContent = cargoType.charAt(0).toUpperCase() + cargoType.slice(1);

            updateVehicleInfo(cargoType);
            updateDriverInfo();
            document.getElementById(cargoType).checked = true;
            initRatingStars();
            previewFare();
        };
        console.log('Is calculateDelivery defined?', typeof calculateDelivery);
        console.log('Is calculateDelivery defined?', typeof calculateDelivery);
    </script>
</body>
</html>